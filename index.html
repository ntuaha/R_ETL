<!DOCTYPE html>
<html>
<head>
  <title>ETL on R</title>
  <meta charset="utf-8">
  <meta name="description" content="ETL on R">
  <meta name="author" content="Cheng Yu Lin (aha) and Jia Wei Chen (jiawei)">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="libraries/widgets/quiz/css/demo.css"></link>
<link rel=stylesheet href="libraries/widgets/bootstrap/css/bootstrap.css"></link>
<link rel=stylesheet href="./assets/css/custom.css"></link>
<link rel=stylesheet href="./assets/css/ribbons.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>ETL on R</h1>
    <h2></h2>
    <p>Cheng Yu Lin (aha) and Jia Wei Chen (jiawei)<br/></p>
  </hgroup>
  <article></article>  
  <footer class = 'license'>
    <a href='http://creativecommons.org/licenses/by-sa/3.0/'>
    <img width = '80px' src = 'http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-sa.png'>
    </a>
  </footer>
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>故事的起源</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:30%' >
 <ol>
<li><code>房價真的太高了嗎?</code></li>
</ol>

</div>    
<div style='float:right;width:66%'>
 <p><img src = './resources/figures/R_ETL_NEWS3.png' height="400px"></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-2" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>故事的起源</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:30%' >
 <ol>
<li>房價真的太高了嗎?</li>
<li><code>大熊被抓了</code></li>
</ol>

</div>    
<div style='float:right;width:66%'>
 <p><img src = './resources/figures/R_ETL_NEWS_2.png' height="400px"></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>故事的起源</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:30%' >
 <ol>
<li>房價真的太高了嗎?</li>
<li>大熊被抓了</li>
<li><code>台灣房市真的要崩盤了嗎？</code></li>
</ol>

</div>    
<div style='float:right;width:66%'>
 <p><img src = './resources/figures/R_ETL_NEWS_1.png' height="400px"></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>在論述台灣房市之前，身為一個<code>資料科學家</code>，第一步是了解問題</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-5">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>本次，我們的問題是<code>房價真的太高了嗎?</code></q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-6" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p>還記得這個<code>新聞</code>吧？ 就從這裡開始
<img src = './resources/figures/R_ETL_NEWS_1.png' height="400px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料在哪裡</h2>
  </hgroup>
  <article data-timings="">
    <p>從上面<code>新聞</code>所述，所以我們想要:</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料在哪裡</h2>
  </hgroup>
  <article data-timings="">
    <p>從上面<code>新聞</code>所述，所以我們想要:</p>

<div style='float:left;width:48%;'>
<h3><code>你想知道什麼資料?</code></h3>

<ol>
<li>GDP</li>
<li>房貸餘額</li>
<li>股價</li>
<li>新聞</li>
<li>地價資訊</li>
</ol>

</div>
  <div style='float:right;width:48%;'>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料在哪裡</h2>
  </hgroup>
  <article data-timings="">
    <p>從上面<code>新聞</code>所述，所以我們想要:</p>

<div style='float:left;width:48%;'>
<h3><code>你想知道什麼資料?</code></h3>

<ol>
<li>GDP</li>
<li>房貸餘額</li>
<li>股價</li>
<li>新聞</li>
<li>地價資訊</li>
</ol>

</div>
  <div style='float:right;width:48%;'>
<h3><code>可能的來源?</code></h3>

<ol>
<li>政府公開資料

<ul>
<li>主計處</li>
<li>央行</li>
</ul></li>
<li>新聞

<ul>
<li>紙本報紙</li>
<li>電視新聞</li>
<li>電子新聞</li>
</ul></li>
<li>股市

<ul>
<li>Yahoo Stock API</li>
</ul></li>
</ol>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-10">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>即便知道資料在哪，可是資料還是如同<code>一盤散沙</code></q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-11" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>看看Raw Data</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_RAWDATA.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-12" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>我們ETL會用到的有</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><code>dplyr</code> 可用<code>類似SQL方法</code>操作data frome</li>
<li><code>xts</code> 處理<code>時間</code>格式好用的套件</li>
<li><code>gdata</code> 可以處理<code>Excel 2007</code>以上的文件</li>
<li><code>quantmod</code> 可以處理<code>股市</code>資料</li>
<li><code>stringr</code> <code>字串</code>相關處理</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-13" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>來上課的，有<code>福</code>了</q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-14" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>DSC的One Piece</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><code>DSC2014Tutorial</code> R社群為了這次Tutorial製作的套件，所有的教材都在這了</li>
</ul>

<pre><code>deps &lt;- available.packages(&quot;http://54.92.61.128/R&quot;)[1,&quot;Depends&quot;]
pkgs &lt;- strsplit(gsub(&quot;\\s&quot;, &quot;&quot;, deps), &quot;,&quot;)[[1]]
for(pkg in pkgs) {
  install.packages(pkg)
}
install.packages(&#39;DSC2014Tutorial&#39;, repo = &#39;http://54.92.61.128/R&#39;, type = &#39;source&#39;)
</code></pre>

<p>安裝之後, 輸入以下指令就可以打開投影片:</p>

<pre><code>slides(&quot;ETL&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>解決資料散亂的方法 - <code>ETL</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-16" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>ETL 的主要內容</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_3.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>今日解決的問題流程 - <code>ETL</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_2.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-18" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>今日課程的目標</h2>
  </hgroup>
  <article data-timings="">
    <h3>學會<strong>extraction</strong>, <strong>cleaning</strong>, <strong>transformation</strong></h3>

<ul>
<li>用R整理<code>結構</code>化資料 <strong>STEP1 房貸餘額1</strong> , <strong>STEP2 GDP</strong></li>
<li>用R整理<code>非結構化</code>資料 <strong>STEP3新聞分析</strong></li>
</ul>

<h3>學會 <strong>load</strong></h3>

<ul>
<li>整併全部的資料 STEP4</li>
</ul>

<h3>邁向 <strong>其他有意思的主題</strong></h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="dark segue" id="slide-19" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>學習，實作，觀察 STEP1</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>ETL <code>第一步</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_2.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-21" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>開始收集資料(房貸餘額)</h2>
  </hgroup>
  <article data-timings="">
    <p>請連線到 
<code>https://survey.banking.gov.tw/statis/stmain.jsp?sys=100&amp;funid=r100</code></p>

<iframe src = 'https://survey.banking.gov.tw/statis/stmain.jsp?sys=100&funid=r100' height='400px'></iframe>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-22" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>開始收集資料</h2>
  </hgroup>
  <article data-timings="">
    <h3>房貸餘額,直接下載現成的csv檔案</h3>

<ul>
<li>直接到<a href="https://raw.githubusercontent.com/ntuaha/TWFS/master/db/cl_info_other.csv">https://raw.githubusercontent.com/ntuaha/TWFS/master/db/cl_info_other.csv</a>下載檔案</li>
<li>應該會看見<code>cl_info_other.csv</code></li>
<li>讀入它!</li>
</ul>

<p>或是</p>

<pre><code class="r">library(DSC2014Tutorial)
ETL_file(&quot;cl_info_other.csv&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-23" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>讀入資料 - read.table</h2>
  </hgroup>
  <article data-timings="">
    <p>至少要記得的 <code>read.table</code></p>

<pre><code>Cl_info = read.table(file=&#39;檔案路徑&#39;,sep=&quot;,&quot;,stringsAsFactors=F,header=T)
</code></pre>

<ul>
<li>輸出形態為<code>Data Frame</code></li>
<li>file 就是指讀入的檔案路徑</li>
<li>sep 指的是欄位分割用的符號,通常csv檔案格式是透過<code>,</code>做分割</li>
<li>stringsAsFactors 預設是<code>True</code>, 會讓讀入的字串都用Factor形態儲存，那麼資料就會轉為整數儲存與額外的對照表</li>
<li>header 預設是<code>False</code>，表示第一行是不是表格標頭，作為輸出的dataframe欄位名的colnames</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-24" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>看看讀入結果</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>View(Cl_info)
str(Cl_info)
</code></pre>

<p><img src = './resources/figures/R_ETL_EXP1.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-25" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>直接讀入是否覺得怪怪的?</q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-26" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>再看一次</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_EXP1.png' height="350px"></img></p>

<ul>
<li><code>etl_dt</code> <code>data_dt</code> 是<code>文字</code>但應該是<code>時間</code></li>
<li><code>bank_code</code> 也是<code>文字</code>但應該是<code>factor</code></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-27" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>Transformation - 資料處理</h2>
  </hgroup>
  <article data-timings="">
    <h3>將資料讀入</h3>

<pre><code>library(DSC2014Tutorial)
Cl_info = read.table(file=ETL_file(&#39;cl_info_other.csv&#39;),header=T,sep=&quot;,&quot;,stringsAsFactors=F)
Cl_info_part = mutate(Cl_info,data_dt = as.POSIXct(data_dt),
                 bank_code = as.factor(bank_code),etl_dt = as.POSIXct(etl_dt))
View(Cl_info_part)
str(Cl_info_part)
</code></pre>

<p><br/></p>

<ul class = "build incremental">
<li>到這裡已經完成第一次的資料<code>Extraction</code>與<code>Transformation</code>了！</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-28" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>看見資料了!但是剛剛處理過程中的<code>mutate</code>是什麼?</q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-29" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>看見資料了!但是剛剛處理過程中的<code>mutate</code>是什麼?</q></p>

<p><q> 在<code>R</code>中用來做<strong>資料清理</strong>與<strong>資料處理</strong>好用的套件<code>dplyr</code>其中之一的函式<q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-30" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q> 接下來我們將介紹三個基本函式 </q></p>

<p><img src = './resources/figures/R_ETL_Fn1.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-31" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-挑選<code>欄位</code>(1/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>select</code> 函式，用來<strong>挑選</strong><code>欄位</code></h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo1 = select(資料表,欄位1,欄位2,欄位3)
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的data frame</li>
<li><code>後續參數</code>為選取的欄位名稱</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select data_dt,bank_nm,mortgage_bal from Cl_info;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_SELECT.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-32" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-挑選<code>欄位</code>(2/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>select</code> 函式，用來<strong>挑選</strong><code>欄位</code></h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo1 = select(Cl_info,data_dt,bank_nm,mortgage_bal)
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的data frame</li>
<li><code>後續參數</code>為選取的欄位名稱</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select data_dt,bank_nm,mortgage_bal from Cl_info;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_SELECT.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-33" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-挑選<code>資料</code></h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>filter</code> 函式，用來<strong>保留</strong>要留下的<code>資料列</code></h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo2 = filter(Cl_info,mortgage_bal&gt;1000000)
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的data frame</li>
<li><code>第二個參數</code>為邏輯運算式，可用data frame裡的欄位，當結果為<code>True</code>時，該筆資料列保留</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select * from Cl_info where mortgage&gt;1000000;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_FILTER.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-34" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-增加<code>特徵</code>欄位(1/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>mutate</code> 用來增加<strong>非彙總</strong>計算<code>欄位</code></h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo3 = mutate(資料表,新欄位名 = 運算式)
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的 data frame</li>
<li><code>第二參數</code>為計算式，也可以用來當做<strong>轉換資料形態</strong>，<strong>變更欄位為名稱</strong>使用</li>
</ul>

<ul class = "build incremental">
<li>例如: bank_code = as.numeric(bank_code)</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select mortgage_bal/1000000 as mortage from Cl_info;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_MUTATE.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-35" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-增加<code>特徵</code>欄位(2/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>mutate</code> 用來增加<strong>非彙總</strong>計算<code>欄位</code></h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo3 = mutate(Cl_info,mortage = mortgage_bal/1000000)
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的 data frame</li>
<li><code>第二參數</code>為計算式，也可以用來當做<strong>轉換資料形態</strong>，<strong>變更欄位為名稱</strong>使用</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select mmortgage_bal/1000000 as mortage from Cl_info;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_MUTATE.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-36" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-<code>排序</code>資料(1/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>arrange</code> 用來重新排序</h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo4 = arrange(資料表,欄位1,desc(欄位2)))
</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的 data frame</li>
<li><code>後續參數</code>為排序用欄位，預設遞增，可以透過<code>desc()</code>變成遞減排序</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select * from Cl_info order by mortage,data_dt desc ;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_ARRANGE.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-37" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-<code>排序</code>資料(2/2)</h2>
  </hgroup>
  <article data-timings="">
    <h3>dplyr <code>arrange</code> 用來重新排序</h3>
  
<div style='float:left;width:68%' >
 <pre><code>Cl_demo4 = arrange(Cl_info,mortgage_bal,desc(data_dt))
</code></pre>

<ul>
<li>輸出data frame</li>
<li><code>第一個參數</code>為輸入的 data frame</li>
<li><code>後續參數</code>為排序用欄位，預設遞增，可以透過<code>desc()</code>變成遞減排序</li>
</ul>

<p><br/></p>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select * from Cl_info order by mortage,data_dt desc ;
</code></pre>

</div>    
<div style='float:right;width:28%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_ARRANGE.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-38" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習時間</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>請幫忙從Cl_info_part找出<code>data_dt</code>,<code>bank_nm</code>,<code>mortgage_bal</code></li>
<li>請幫忙從Cl_info_part挑選出<code>mortgage＿bal</code>大於1千萬的銀行資料</li>
<li>請幫忙排序Cl_info_part出<code>mortgage＿bal</code>由小到大，但資料時間<code>data_dt</code>從大到小</li>
<li>請執行下面程式碼，我們後續會利用<code>Cl_info_part2</code></li>
</ol>

<pre><code>Cl_info_part2 = mutate(Cl_info_part,time= as.POSIXct(data_dt))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="dark segue" id="slide-39" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>學習，實作，觀察 STEP2</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-40" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>讓我們來練習抓下一個資料<code>GDP</code></q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-41" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>ETL <code>第二步</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_2.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-42" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>開始收集資料(GDP)</h2>
  </hgroup>
  <article data-timings="">
    <p>請連線到 <code>http://ebas1.ebas.gov.tw/pxweb/Dialog/NI.asp</code></p>

<iframe src = 'http://ebas1.ebas.gov.tw/pxweb/Dialog/NI.asp' height='400px'></iframe>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-43" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>開始收集資料(GDP)</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>GDP從直接下載<code>國民生產毛額之處分</code></li>
<li>季(1980之後）</li>
<li>選<strong>全部的日期</strong></li>
<li>選<strong>全部的計價方式</strong></li>
<li>項目選<strong>GDP</strong></li>
<li>總類選<strong>原始值</strong></li>
<li>按繼續後，選<strong>從螢幕顯示Excel檔</strong></li>
<li>開啟後，<strong>另存新檔成csv檔</strong></li>
<li>開回<code>RStudio</code> 開始處理資料</li>
</ol>

<p>或是<code>ETL_file(&quot;GDP.txt&quot;)</code></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-44">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>練習讀入與創建一個<code>GDP</code>的 data frame</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="quote" id="slide-45" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>答案</q></p>

<pre><code class="r">GDP = read.table(file=ETL_file(&quot;GDP.txt&quot;),sep=&quot;,&quot;,stringsAsFactors=F,header=F)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-46" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>輸入<code>View(GDP)</code>觀察<code>GDP</code>會發現怎麼前後有很多列的資料是不要的</q>
<img src = './resources/figures/R_ETL_2.png' ></img></p>

<h3>好亂，我想<code>整理</code>好這個data frome</h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-47" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料清理</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:38%' >
 <h3>要處理的標的物有</h3>

<ol>
<li>去除前後<code>不相干</code>的資料列</li>
<li>轉換欄位的格式

<ul>
<li>將單位轉換，從<code>百萬元變成元</code></li>
<li>將不應該出現的<code>,</code>去除</li>
</ul></li>
<li>抽離<code>年份</code>與<code>季</code></li>
</ol>

</div>    
<div style='float:right;width:58%'>
 <p><img src = './resources/figures/R_ETL_1.png' ></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-48" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>去除前後不相干的資料列</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>GDP_part = GDP[5:137,]
</code></pre>

<h3>別忘了改上欄位名稱</h3>

<pre><code>colnames(GDP_part) = c(&quot;time&quot;,&quot;GDP&quot;,&quot;GDP_yoy&quot;,&quot;GDP_2006&quot;,&quot;GDP_2006_yoy&quot;,
                        &quot;GDP_minus&quot;,&quot;GDP_minus_yoy&quot;)
</code></pre>

<p><img src = './resources/figures/R_ETL_GDP_1.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-49" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>去除rownames</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>rownames(GDP_part) = NULL
View(GDP_part)
</code></pre>

<p>另外一個簡單的例子</p>

<pre><code>iris
iris_part &lt;- iris[4:6,]
rownames(iris_part) &lt;- c(&#39;a&#39;,&#39;c&#39;,&#39;d&#39;)
View(iris_part)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-50" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>轉移文字格式</h2>
  </hgroup>
  <article data-timings="">
    <pre><code># 去除中間不合理的,在數字欄位上與補上百萬
GDP_part2= mutate(GDP_part,GDP = as.numeric(gsub(&quot;,&quot;, &quot;&quot;,GDP))*1000000)

</code></pre>

<ol>
<li>我們利用了 <code>gsub</code>, 替換字元，將原先有問題的<code>,</code>去除</li>
<li>而後利用了<code>as.numeric</code> 將原來的<code>文字</code>形態改成<code>數字</code></li>
</ol>

<p><img src = './resources/figures/R_ETL_GDP2.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-51" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>抽離年份與季</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>GDP_part3 = mutate(GDP_part2,year=as.numeric(substr(time,0,4)),
                            season=as.numeric(substr(time,6,6)))
GDP_part4 = select(GDP_part3,year,season,GDP)
</code></pre>

<ol>
<li>我們利用了 <code>substr</code>, 取出特定位置的資料</li>
<li>再次利用<code>as.numeric</code>, 將文字轉成數字</li>
</ol>

<p><img src = './resources/figures/R_ETL_GDP3.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-52" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習時間</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>去除頭尾不合理的資料列</li>
<li>去除GDP的 <code>,</code> , 然後將它轉成數字</li>
<li>將<code>year</code>,<code>season</code>抽離出來並轉成數字，同時最後資料只保留<code>GDP</code>,<code>year</code>,<code>season</code></li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="quote" id="slide-53" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <article data-timings="">
    <p><q>擁有了<code>GDP</code>和<code>房貸餘額</code>，那接下來呢?</a>
<img src = './resources/figures/R_ETL_PART2.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-54">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q><code>非結構化</code>的新聞與股市資料!</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-55" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>學習，實作，觀察 STEP3</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-56" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>ETL <code>第三步</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_2.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-57" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>匯入套件</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">require(RSelenium)
require(stringr)
require(xts)
require(reshape2)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-58" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>先 check / 安裝 聯結 Selenium 的 driver</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">checkForServer()
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-59" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>打開 瀏覽器</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">startServer()
remDr &lt;- remoteDriver(browserName = &quot;firefox&quot;) # mac 可用 safari

remDr$open()
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-60" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>抓 yahoo 新聞</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">title &lt;- list()

for(i in 1:10){
  url &lt;- sprintf(&#39;https://tw.news.yahoo.com/real-estate/archive/%d.html&#39;, i)
  remDr$navigate(url)
  doc &lt;- remDr$findElements(&quot;xpath&quot;, &quot;//ul/li/div/div/h4/a&quot;)
  tmp &lt;- sapply(doc, function(doc){
    doc$getElementText()})
  title &lt;- append(title, tmp)
} 
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-61" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>抓 yahoo 搜尋結果</h2>
  </hgroup>
  <article data-timings="">
    <h3>搜尋 房價</h3>

<pre><code class="r">
remDr$navigate(&quot;https://tw.yahoo.com/&quot;)
webElem &lt;- remDr$findElement(using = &quot;id&quot;, &quot;p&quot;)
webElem$sendKeysToElement(list(&quot;房價&quot;, key = &quot;enter&quot;))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-62" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>抓搜尋結果</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">search_title &lt;- list()
for(i in 1:10){
  webElems &lt;- remDr$findElements(using = &quot;xpath&quot;, &quot;//li/div/div/h3/a&quot;)
  resHeaders &lt;- unlist(lapply(webElems, function(x){x$getElementText()}))

  search_title &lt;- append(search_title, resHeaders)
  webElems &lt;- remDr$findElement(using = &quot;id&quot;, value = &quot;pg-next&quot;)
  webElems$clickElement()

}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-63" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>儲存 / 讀取 表格資料</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">setwd(&#39;~/R_ETL/jiawei/)

doc_1 &lt;- do.call(rbind, title)
doc_2 &lt;- do.call(rbind, search_title)
writeLines(doc_1, &quot;news_yahoo.txt&quot;)
writeLines(doc_2, &quot;search_yahoo.txt&quot;)
news_yahoo &lt;- readLines(&#39;news_yahoo.txt&#39;)
search_yahoo &lt;- readLines(&#39;search_yahoo.txt&#39;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-64" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>優缺點</h2>
  </hgroup>
  <article data-timings="">
    <ul class = "build incremental">
<li>優：可以輕易上手，和使用瀏覽器經驗幾乎一樣</li>
<li>缺：速度慢，不適合抓大規模資料</li>
<li>可以搭配使用 <a href="http://rpubs.com/johndharrison/RSelenium-headless">phantomjs</a> ，速度會比較快 </li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-65" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>匯入這次用的資料</h2>
  </hgroup>
  <article data-timings="">
    <h3><a href="http://house.cnyes.com/News/tw_housenews/List.htm">鉅亨網　房地產新聞</a></h3>

<pre><code class="r">setwd(&#39;~/R_ETL&#39;)
hourse_news &lt;- readLines(&#39;jiawei/news.txt&#39;) 
head(hourse_news)
</code></pre>

<pre><code>## [1] &quot;2014-06-24富邦人壽信義區再插旗 A25案172億元奪標&quot;                          
## [2] &quot;2014-06-24北市A25地上權案 富邦權利金172.88億元得標&quot;                       
## [3] &quot;2014-06-23房市管制 央行將化明為暗&quot;                                        
## [4] &quot;2014-06-20史上頭一遭!大直新地王 1坪212萬＃超越信義之星直逼帝寶 中山新天價&quot;
## [5] &quot;2014-06-20大直帝景水花園實價首破200萬 北市3大豪宅板塊確立&quot;                
## [6] &quot;2014-06-19樺福千金捷運宅標脫率89.4% 均價63萬元屬合理範圍&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-66" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>抓出 時間 與 文章</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CB4QFjAA&amp;url=http%3A%2F%2Fstatlab.nchc.org.tw%2Frnotes%2F%3Fpage_id%3D171&amp;ei=xWzSU9fGEIiB8gW91IKYCQ&amp;usg=AFQjCNE71BgJhsypu4NhHxgpk3pDTOGZ9g&amp;sig2=ie3biJghIW601YTFHbbZJg&amp;bvm=bv.71667212,d.dGc">常規表示法| R 學習筆記</a></li>
<li><a href="http://deerchao.net/tutorials/regex/regex.htm">正则表达式30分钟入门教程</a></li>
</ul>

<pre><code class="r">dates &lt;- str_extract(hourse_news, &quot;\\d{4}-\\d{2}-\\d{2}&quot;)
titles &lt;- str_replace(hourse_news, &quot;\\d{4}-\\d{2}-\\d{2}&quot;, &quot;&quot;)

hourse_news &lt;- cbind(dates, titles)
</code></pre>

<pre><code>##      dates        titles                                    
## [1,] &quot;2014-06-24&quot; &quot;富邦人壽信義區再插旗 A25案172億元奪標&quot;   
## [2,] &quot;2014-06-24&quot; &quot;北市A25地上權案 富邦權利金172.88億元得標&quot;
## [3,] &quot;2014-06-23&quot; &quot;房市管制 央行將化明為暗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-67" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>有了新聞後，怎麼知道有哪些單字？</h2>
  </hgroup>
  <article data-timings="">
    <ul class = "build incremental">
<li><p>自己手動打？ex. 房價、北市,、捷運 ...</p></li>
<li><p>用程式從文章抓 ??  </p></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-68" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>有了新聞後，怎麼知道有哪些單字？</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><p>自己手動打？ex. 房價、北市,、捷運 ...</p></li>
<li><p>用程式從文章抓</p></li>
</ul>

<pre><code class="r">substr(&#39;富邦人壽信義區再插旗 A25案172億元奪標&#39;, 1, 4)
</code></pre>

<pre><code>## [1] &quot;富邦人壽&quot;
</code></pre>

<pre><code class="r">substr(&#39;富邦人壽信義區再插旗 A25案172億元奪標&#39;, 5, 7)
</code></pre>

<pre><code>## [1] &quot;信義區&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-69" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>等下要用到的工具 -&gt; substr</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">sentence &lt;- &#39;富邦人壽信義區再插旗&#39;

n &lt;- 3

i &lt;- 1
substr(sentence, i, i+n-1)
</code></pre>

<pre><code>## [1] &quot;富邦人&quot;
</code></pre>

<pre><code class="r">i &lt;- 2
substr(sentence, i, i+n-1)
</code></pre>

<pre><code>## [1] &quot;邦人壽&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-70" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>N-Grame</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">ngram &lt;- function(sentence, n){
  chunk &lt;- c()
  for(i in 1 : (nchar(sentence)-n+1)){
    chunk &lt;- append(chunk, substr(sentence, i, i+n-1))
  }
  return(chunk)
}
</code></pre>

<pre><code class="r">ngram(&#39;富邦人壽信義區再插旗&#39;, 2)
</code></pre>

<pre><code>## [1] &quot;富邦&quot; &quot;邦人&quot; &quot;人壽&quot; &quot;壽信&quot; &quot;信義&quot; &quot;義區&quot; &quot;區再&quot; &quot;再插&quot; &quot;插旗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-71" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>把 N-Gram 詞彙匯聚在一起</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">piece &lt;- c()

for(i in 1:length(hourse_news)){
  piece &lt;- append(piece, ngram(titles[i], 1))
  piece &lt;- append(piece, ngram(titles[i], 2))
  piece &lt;- append(piece, ngram(titles[i], 3))
  piece &lt;- append(piece, ngram(titles[i], 4))
  piece &lt;- append(piece, ngram(titles[i], 5))
  piece &lt;- append(piece, ngram(titles[i], 6))
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-72" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>清除符號 (只是列出來，並沒有要做)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">piece_clean &lt;- str_replace_all(piece, punctuation, &quot;&quot;)
piece_clean &lt;- str_replace_all(piece_clean, &quot;[[:punct:]]&quot;, &quot;&quot;)
piece_clean &lt;- str_replace_all(piece_clean, &quot;[[:blank:]]&quot;, &quot;&quot;)
piece_clean &lt;- str_replace_all(piece_clean, &quot; &quot;, &quot;&quot;)

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-73" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>如果想清除中文特殊符號 ...</h2>
  </hgroup>
  <article data-timings="">
    <h3>這是 utf-8 編碼</h3>

<pre><code class="r">punctuation &lt;- &quot;\u3002 \uff1b \uff0c \uff1a \u201c \u201d \uff08 \uff09 \u3001 \uff1f \u300a \u300b&quot;

punctuation
</code></pre>

<pre><code>## [1] &quot;。 ； ， ： “ ” （ ） 、 ？ 《 》&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-74" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算 單字 出現次數</h2>
  </hgroup>
  <article data-timings="">
    <h3>整理次數的好用工具 -&gt; table</h3>

<pre><code class="r">piece_clean &lt;- piece
word_freq &lt;- table(piece_clean)
</code></pre>

<pre><code>## piece_clean
## 信義區   北市   房價   房市   上漲 
##      8     81     38     33      2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-75" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>分出 單字長度 區塊</h2>
  </hgroup>
  <article data-timings="">
    <h3>list 的key-value 資料結構是種好用的工具</h3>

<pre><code class="r">words_length &lt;- 
list(
  &quot;1&quot; = names(word_freq[nchar(names(word_freq))==1]),
  &quot;2&quot; = names(word_freq[nchar(names(word_freq))==2]),
  &quot;3&quot; = names(word_freq[nchar(names(word_freq))==3]),
  &quot;4&quot; = names(word_freq[nchar(names(word_freq))==4]),
  &quot;5&quot; = names(word_freq[nchar(names(word_freq))==5]),
  &quot;6&quot; = names(word_freq[nchar(names(word_freq))==6])
)

tail(words_length[[&quot;2&quot;]])
</code></pre>

<pre><code>## [1] &quot;最新&quot; &quot;作品&quot; &quot;坐5&quot;  &quot;坐擁&quot; &quot;座排&quot; &quot;做半&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-76" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>等下要用到工具</h2>
  </hgroup>
  <article data-timings="">
    <h3>單字長度 1 的內容</h3>

<pre><code class="r">words_length[[&#39;1&#39;]]
</code></pre>

<pre><code>## [1] &quot;祖&quot; &quot;最&quot; &quot;作&quot; &quot;坐&quot; &quot;座&quot; &quot;做&quot;
</code></pre>

<h3>這些字的出現次數</h3>

<pre><code class="r">word_freq[words_length[[&#39;1&#39;]]]
</code></pre>

<pre><code>## piece_clean
## 祖 最 作 坐 座 做 
##  2 36  2  2  1  1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-77" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算出機率</h2>
  </hgroup>
  <article data-timings="">
    <h3>把次數sum 起來當分母，算相對次數</h3>

<pre><code class="r">N &lt;- sum(word_freq[words_length[[&#39;1&#39;]]])
words_weight &lt;- word_freq / N
</code></pre>

<pre><code>## piece_clean
##         做半       做半套     做半套？   做半套？政 做半套？政院 
##    0.0001481    0.0001481    0.0001481    0.0001481    0.0001481
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-78" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>等下要用的工具 paste, grep</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">paste(&quot;富邦&quot; ,&quot;人壽&quot;, sep=&#39;&#39;)
</code></pre>

<pre><code>## [1] &quot;富邦人壽&quot;
</code></pre>

<pre><code class="r">grep(&#39;富邦&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<pre><code class="r">grep(&#39;^富邦&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">grep(&#39;富邦$&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-79" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算出單字左右亂度</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">disorder &lt;- function(word){

  BASE &lt;- words_length[[as.character(nchar(word)+1)]]

  PATTEN1 &lt;- paste(&quot;^&quot;, word, sep = &#39;&#39;)
  matchs1 &lt;- grep(PATTEN1, BASE, value = TRUE)
  pre &lt;- mean(-log2(words_weight[matchs1]))

  PATTEN2 &lt;- paste(word, &quot;$&quot;, sep = &#39;&#39;)
  matchs2 &lt;- grep(PATTEN2, BASE, value = TRUE)
  post &lt;- mean(-log2(words_weight[matchs2]))

  index &lt;- is.na(c(pre, post))
  condition &lt;- any(index)
  return(ifelse(condition, c(pre, post)[index], min(pre, post)))

}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-80" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>可以先用簡單例子看一下上面的結果</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">word &lt;- &#39;富邦&#39;
BASE &lt;- words_length[[as.character(nchar(word)+1)]]
</code></pre>

<pre><code>## [1] &quot;最新實&quot; &quot;作品將&quot; &quot;坐5望&quot;  &quot;坐擁水&quot; &quot;座排行&quot; &quot;做半套&quot;
</code></pre>

<pre><code class="r">PATTEN1 &lt;- paste(&quot;^&quot;, word, sep = &#39;&#39;)
grep(PATTEN1, BASE, value = TRUE)
</code></pre>

<pre><code>## [1] &quot;富邦權&quot; &quot;富邦人&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-81" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>挑出文章裡面的 單字</h2>
  </hgroup>
  <article data-timings="">
    <h3>先挑出單字長度 2~5 的 候選詞彙</h3>

<pre><code class="r">word_2_5 &lt;- unlist(words_length[2:5])
</code></pre>

<pre><code>##   2535   2592   2470   2406   2504   2889   2774   2549   2972   2192 
##  &quot;7大&quot;   &quot;IT&quot;  &quot;4坪&quot;  &quot;2公&quot;  &quot;5月&quot; &quot;出售&quot; &quot;不想&quot;   &quot;8%&quot; &quot;當家&quot; &quot;、高&quot; 
##   2138   2671   2593   2162   2281 
##  &quot; 未&quot; &quot;包租&quot;   &quot;KA&quot;  &quot; 整&quot; &quot;？北&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-82">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  <h2>單字 出現次數分佈</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src="assets/fig/unnamed-chunk-26.png" alt="plot of chunk unnamed-chunk-26"> </p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-83" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算出 候選詞彙 左右兩側的混亂程度</h2>
  </hgroup>
  <article data-timings="">
    <h3>出現次數&gt;2 的 候選詞彙</h3>

<pre><code class="r">words &lt;- names(which(word_freq[word_2_5] &gt; 2))
</code></pre>

<h3>把 候選詞彙 丟下去計算</h3>

<pre><code class="r">disorder_val &lt;- sapply(words, disorder, USE.NAMES = FALSE)
names(disorder_val) &lt;- words
</code></pre>

<pre><code>##  [1] &quot;台北市&quot;   &quot;下半年&quot;   &quot;增2成&quot;    &quot;中山、&quot;   &quot;2013&quot;     &quot;6.6萬&quot;   
##  [7] &quot;北市房價&quot; &quot;北市去年&quot; &quot;地上權案&quot; &quot;房市交易&quot; &quot;高房價 &quot;  &quot;合宜住宅&quot;
## [13] &quot;臨沂帝國&quot; &quot;實價揭露&quot; &quot;新隆國宅&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-84">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  <h2>單字的 混亂程度分佈</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src="assets/fig/unnamed-chunk-30.png" alt="plot of chunk unnamed-chunk-30"> </p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-85" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>混亂程度</h2>
  </hgroup>
  <article data-timings="">
    <h3>兩側混亂程度高的字</h3>

<pre><code>##  [1] &quot;台北市&quot;   &quot;下半年&quot;   &quot;增2成&quot;    &quot;中山、&quot;   &quot;2013&quot;     &quot;6.6萬&quot;   
##  [7] &quot;北市房價&quot; &quot;北市去年&quot; &quot;地上權案&quot; &quot;房市交易&quot; &quot;高房價 &quot;  &quot;合宜住宅&quot;
## [13] &quot;臨沂帝國&quot; &quot;實價揭露&quot; &quot;新隆國宅&quot;
</code></pre>

<h3>兩側混亂程度低的字</h3>

<pre><code>##  [1] &quot;014&quot;    &quot;14-&quot;    &quot;014-&quot;   &quot;14-0&quot;   &quot;014-0&quot;  &quot;2014-&quot;  &quot;登錄&quot;  
##  [8] &quot;價登&quot;   &quot;實價登&quot; &quot;地政&quot;   &quot;政士&quot;   &quot;地上&quot;   &quot;上權&quot;   &quot;坪1&quot;   
## [15] &quot;士法&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-86" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>挑出 混亂程度&gt;12 的單字</h2>
  </hgroup>
  <article data-timings="">
    <h3>根據前面的分佈圖來決定用 &gt; 12 ...</h3>

<pre><code class="r">test_words &lt;- names(which(disorder_val &gt; 12))
</code></pre>

<pre><code>##  [1] &quot;臨沂帝國&quot;   &quot;陸客效應&quot;   &quot;每坪12&quot;     &quot;年漲15&quot;     &quot;全台店面&quot;  
##  [6] &quot;商用大樓&quot;   &quot;社會住宅&quot;   &quot;實價登錄&quot;   &quot;實價揭露&quot;   &quot;新隆國宅&quot;  
## [11] &quot;信義之星&quot;   &quot;中山區最&quot;   &quot;住宅價格&quot;   &quot; 張盛和：&quot;  &quot;：豪宅交易&quot;
## [16] &quot;25日前提&quot;   &quot;捷運松山線&quot; &quot;桃園房價漲&quot; &quot;逾3.5%&quot;     &quot;月實價登錄&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-87" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>切單字</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">segmentWord &lt;- function(word){
  n &lt;- nchar(word)-1
  seg &lt;- lapply(1: n, function(i){
    w1 &lt;- substr(word, 1, i)
    w2 &lt;- substr(word,i+1, n+1)
    c(w1,w2)
  })
  return(seg)
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-88" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">segmentWord(&#39;富邦人壽&#39;)
</code></pre>

<pre><code>## [[1]]
## [1] &quot;富&quot;     &quot;邦人壽&quot;
## 
## [[2]]
## [1] &quot;富邦&quot; &quot;人壽&quot;
## 
## [[3]]
## [1] &quot;富邦人&quot; &quot;壽&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-89" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>可以用這例子來理解</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">word &lt;- &#39;富邦人壽&#39;
i = 1
substr(word, 1, i)
</code></pre>

<pre><code>## [1] &quot;富&quot;
</code></pre>

<pre><code class="r">substr(word,i+1, n+1)
</code></pre>

<pre><code>## [1] &quot;邦人壽&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-90" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算單字的凝聚程度</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">cohesion &lt;- function(word){
  seg &lt;- segmentWord(word)
  val &lt;- sapply(seg, function(x){    
    f_word &lt;- word_freq[word]
    f_x1 &lt;- word_freq[x[1]]
    f_x2 &lt;- word_freq[x[2]]
    mi &lt;- log2(N) + log2(f_word) - log2(f_x1) - log2(f_x2)
    return(mi)
  }) 
  return (min(val))
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-91" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>用這例子來理解, 依序為 f_word, f_x1, f_x2</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">word &lt;- &#39;富邦人壽&#39;
word_freq[word]    
</code></pre>

<pre><code>## 富邦人壽 
##        3
</code></pre>

<pre><code class="r">word_freq[&#39;富邦&#39;]
</code></pre>

<pre><code>## 富邦 
##    4
</code></pre>

<pre><code class="r">word_freq[&#39;人壽&#39;]
</code></pre>

<pre><code>## 人壽 
##    3
</code></pre>

<hr>

<h2>抓凝聚程度較高的字</h2>

<pre><code class="r">cohesion_val &lt;- sapply(test_words, cohesion, USE.NAMES = FALSE)
names(cohesion_val) &lt;- test_words
test_words_2 &lt;- names(which(cohesion_val &gt; 2))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-92" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>等下要用到的工具 -&gt; str_count</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">fruit &lt;- c(&quot;apple&quot;, &quot;banana&quot;, &quot;pear&quot;, &quot;pineapple&quot;)
str_count(fruit, &quot;a&quot;)
</code></pre>

<pre><code>## [1] 1 3 1 1
</code></pre>

<pre><code class="r">str_count(fruit, &quot;p&quot;)
</code></pre>

<pre><code>## [1] 2 0 1 3
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-93" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算出單字 每個時間點的 出現次數</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">tmp &lt;- lapply(test_words_2, function(word) str_count(titles, word))
words_tbl &lt;- do.call(cbind, tmp)
colnames(words_tbl) &lt;- test_words_2
rownames(words_tbl) &lt;- dates
</code></pre>

<pre><code>##            租金 9. 17% 調查： 29 -1 第4 、台
## 2014-06-24    0  0   0      0  0  0   0    0
## 2014-06-24    0  0   0      0  0  0   0    0
## 2014-06-23    0  0   0      0  0  0   0    0
## 2014-06-20    0  0   0      0  0  0   0    0
## 2014-06-20    0  0   0      0  0  0   0    0
## 2014-06-19    0  1   0      0  0  0   0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-94" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>轉換成 xts格式</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">words_tbl_xts &lt;- xts(words_tbl, as.POSIXct(dates))
</code></pre>

<h3>可以選取時間</h3>

<pre><code class="r">words_tbl_xts[&quot;2014-01-18/2014-01-20&quot;, 100:110]
</code></pre>

<pre><code>##            公園 共識 購屋 關  夯　 豪宅 好宅 換屋 價差 價高 價最
## 2014-01-19    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    1    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    0    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-95" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>對時間區間做運算</h2>
  </hgroup>
  <article data-timings="">
    <h3>1~2月 每個禮拜的出現次數做加總</h3>

<pre><code class="r">ep.weeks &lt;- endpoints(words_tbl_xts, &quot;weeks&quot;, k=1)
count.weeks &lt;- period.apply(words_tbl_xts, ep.weeks, FUN=colSums)
count.weeks[&quot;2014-01/2014-02&quot;, 100:110]
</code></pre>

<pre><code>##            公園 共識 購屋 關  夯　 豪宅 好宅 換屋 價差 價高 價最
## 2014-01-06    0    0    0   0    0    0    0    0    0    0    0
## 2014-01-10    0    0    0   0    0    2    0    0    0    0    0
## 2014-01-20    0    0    0   0    0    3    0    0    0    1    0
## 2014-01-27    0    0    0   0    2    2    0    0    0    0    0
## 2014-01-28    0    0    0   2    0    0    0    0    0    0    0
## 2014-02-07    0    0    0   0    0    0    0    0    0    0    0
## 2014-02-17    1    0    3   0    0    3    0    0    0    1    0
## 2014-02-24    0    0    2   0    0    1    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-96" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>下載營建股 股票指數</h2>
  </hgroup>
  <article data-timings="">
    <h3><a href="http://www.wantgoo.com/stock/classcont.aspx?id=32">營建股清單</a></h3>

<p>或是用套件中的資料</p>

<pre><code class="r">library(DSC2014Tutorial)
f = file(ETL_file(&quot;stock.csv&quot;))# file(&#39;~/stock.csv&#39;, encoding=&#39;utf-8&#39;)
stock &lt;- read.csv(f, stringsAsFactors=FALSE)

stock_no &lt;- stock[,1]
stock_name &lt;- stock[,2]
stock_code &lt;- paste(stock_no, &#39;.TW&#39;, sep=&#39;&#39;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-97" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>開始下載</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">getSymbols(stock_code, env=mystocks, from=&quot;2014-01-01&quot;, to=&quot;2014-07-02&quot;)
mystocks &lt;- do.call(cbind,eapply(mystocks, Cl))
names(mystocks) &lt;- stock_name
saveRDS(mystocks, &quot;mystocks.rds&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-98" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算出每支股票的 平均漲跌</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">mystocks &lt;- readRDS(ETL_file(&quot;mystocks.rds&quot;))#readRDS(&#39;jiawei/mystocks.rds&#39;)
mystocks.return &lt;- diff(mystocks, 1) / mystocks
</code></pre>

<pre><code>##               華友聯      名軒      寶徠      潤隆      國建
## 2014-01-01        NA        NA        NA        NA        NA
## 2014-01-02  0.004545  0.005310 -0.008333 -0.006390 -0.001631
## 2014-01-03 -0.013825 -0.005338  0.012346 -0.006431 -0.003273
## 2014-01-06 -0.004630 -0.008977 -0.021008 -0.054237 -0.006590
## 2014-01-07  0.000000  0.003578  0.004184  0.018303  0.017799
## 2014-01-08  0.022624  0.001786 -0.012712  0.003317  0.006431
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-99" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>全部平均來看 ...</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">mystocks.return_all &lt;- apply(mystocks.return[-1,], 1, mean)
</code></pre>

<p><img src="assets/fig/unnamed-chunk-50.png" alt="plot of chunk unnamed-chunk-50"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-100" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>找出股票漲跌的五個狀態</h2>
  </hgroup>
  <article data-timings="">
    <h3>漲多,、漲少,、不變,、跌少,、跌多</h3>

<h3>利用 kmeans 來判斷</h3>

<pre><code class="r">cl &lt;- kmeans(mystocks.return_all, 5)
return.status &lt;- data.frame(cl$cluster)
</code></pre>

<pre><code>##            cl.cluster
## 2014-01-02          4
## 2014-01-03          2
## 2014-01-06          5
## 2014-01-07          3
## 2014-01-08          4
## 2014-01-09          2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-101" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>如果想知道其中的 <code>相關性</code> ...</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
<h3><code>關鍵字出現的次數</code></h3>

<pre><code>##            公園 共識 購屋 關  夯　 豪宅
## 2014-06-24    0    0    0   0    0    0
## 2014-06-24    0    0    0   0    0    0
## 2014-06-23    0    0    0   0    0    0
## 2014-06-20    0    0    0   0    0    0
## 2014-06-20    0    0    0   0    0    1
## 2014-06-19    0    0    0   0    0    0
</code></pre>

</div>
  <div style='float:right;width:48%;'>
<h3><code>股市漲跌的狀態</code></h3>

<pre><code>##            cl.cluster
## 2014-01-02          4
## 2014-01-03          2
## 2014-01-06          5
## 2014-01-07          3
## 2014-01-08          4
## 2014-01-09          2
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-102" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>如果可以把<code>5個漲跌狀態</code>變成欄位 ...</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
<h3>原本的表格</h3>

<pre><code>##            cl.cluster
## 2014-01-02          4
## 2014-01-03          2
## 2014-01-06          5
## 2014-01-07          3
## 2014-01-08          4
## 2014-01-09          2
</code></pre>

</div>
  <div style='float:right;width:48%;'>
<h3>希望的表格</h3>

<pre><code>##         date 1 2 3 4 5
## 1 2014-01-02 0 0 0 4 0
## 2 2014-01-03 0 2 0 0 0
## 3 2014-01-06 0 0 0 0 5
## 4 2014-01-07 0 0 3 0 0
## 5 2014-01-08 0 0 0 4 0
## 6 2014-01-09 0 2 0 0 0
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-103" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>整理出需要的欄位狀態</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">return_date &lt;- rownames(return.status)
return.status &lt;- cbind(return_date, &quot;status&quot;=return.status)
return.status &lt;- cbind(return.status, &quot;val&quot;=rep(1,127))
</code></pre>

<pre><code>##            return_date cl.cluster val
## 2014-01-02  2014-01-02          4   1
## 2014-01-03  2014-01-03          2   1
## 2014-01-06  2014-01-06          5   1
## 2014-01-07  2014-01-07          3   1
## 2014-01-08  2014-01-08          4   1
## 2014-01-09  2014-01-09          2   1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-104" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>欄位旋轉</h2>
  </hgroup>
  <article data-timings="">
    <h3>將<code>漲跌狀態</code>旋轉到欄位</h3>

<pre><code class="r">return.status &lt;- dcast(return.status, return_date  ~ cl.cluster, fill = 0)
</code></pre>

<h3>轉換成<code>xts</code>格式</h3>

<pre><code class="r">return.status &lt;- data.frame(return.status,stringsAsFactors=FALSE)
return.status.xts &lt;- xts(return.status[,-1], as.POSIXct(return_date))
</code></pre>

<pre><code>##            X1 X2 X3 X4 X5
## 2014-01-02  0  0  0  1  0
## 2014-01-03  0  1  0  0  0
## 2014-01-06  0  0  0  0  1
## 2014-01-07  0  0  1  0  0
## 2014-01-08  0  0  0  1  0
## 2014-01-09  0  1  0  0  0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-105" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>把<code>關鍵字</code>和<code>股票漲跌</code>依據<code>時間</code>做合併</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">final_tbl &lt;- merge.xts(words_tbl_xts, return.status.xts, fill=0)
names(final_tbl) &lt;- c(test_words_2, names(return.status[,-1]))
</code></pre>

<pre><code>##            捷運松山線 桃園房價漲 逾3.5% 月實價登錄 X1 X2 X3 X4 X5
## 2014-01-02          0          0      0          0  0  0  0  1  0
## 2014-01-02          0          0      0          0  0  0  0  0  0
## 2014-01-02          0          0      0          0  0  0  0  0  0
## 2014-01-02          0          0      0          0  0  0  0  0  0
## 2014-01-03          0          0      0          0  0  1  0  0  0
## 2014-01-03          0          0      0          0  0  0  0  0  0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-106" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>算 彼此之間的相關度</h2>
  </hgroup>
  <article data-timings="">
    <h3>計算 <code>共變異矩陣</code></h3>

<pre><code class="r">tbl_cov &lt;- cov(final_tbl)
</code></pre>

<h3>計算 <code>曼哈頓距離</code></h3>

<pre><code class="r">d &lt;- dist(t(final_tbl),  method = &quot;manhattan&quot;)
d2 &lt;- as.matrix(d) 
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-107" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>和<code>漲跌狀態</code>有關的<code>關鍵字</code></h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
<h3>和<code>X1狀態</code>較接近的關鍵字</h3>

<pre><code class="r">score &lt;- sort(d2[,&#39;X1&#39;])
words &lt;- names(score)
head(data.frame(words), 10)
</code></pre>

<pre><code>##    words
## 1     X1
## 2    8萬
## 3  每坪7
## 4    9.4
## 5     40
## 6     9%
## 7    關 
## 8   換屋
## 9   可以
## 10  市最
</code></pre>

</div>
  <div style='float:right;width:48%;'>
<h3>和<code>X4狀態</code>較接近的關鍵字</h3>

<pre><code class="r">score &lt;- sort(d2[,&#39;X4&#39;])
words &lt;- names(score)
head(data.frame(words), 10)
</code></pre>

<pre><code>##     words
## 1      X4
## 2      48
## 3     減1
## 4     2.4
## 5    年減
## 6    現身
## 7    置產
## 8    平均
## 9  不動產
## 10 財長：
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-108" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>整理一下 ...</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">kw &lt;- list()
for(i in 1:5){
  col &lt;- sprintf(&quot;X%s&quot;, i)
  kw &lt;- cbind(kw, names(head(sort(d2[,col]), 10)))
}
</code></pre>

<pre><code>##       [,1]    [,2]       [,3]   [,4]     [,5]    
##  [1,] &quot;X1&quot;    &quot;X2&quot;       &quot;X3&quot;   &quot;X4&quot;     &quot;X5&quot;    
##  [2,] &quot;8萬&quot;   &quot;標脫&quot;     &quot;打造&quot; &quot;48&quot;     &quot;台開決&quot;
##  [3,] &quot;每坪7&quot; &quot;、新&quot;     &quot;點閱&quot; &quot;減1&quot;    &quot;總銷&quot;  
##  [4,] &quot;9.4&quot;   &quot;%最&quot;      &quot;房貸&quot; &quot;2.4&quot;    &quot; 將&quot;   
##  [5,] &quot;40&quot;    &quot;標售&quot;     &quot;馬年&quot; &quot;年減&quot;   &quot; 全&quot;   
##  [6,] &quot;9%&quot;    &quot;店租&quot;     &quot;所得&quot; &quot;現身&quot;   &quot; 仍&quot;   
##  [7,] &quot;關 &quot;   &quot;捷運宅&quot;   &quot;推案&quot; &quot;置產&quot;   &quot;　新&quot;  
##  [8,] &quot;換屋&quot;  &quot;28&quot;       &quot;網路&quot; &quot; 平均&quot;  &quot; 應&quot;   
##  [9,] &quot;可以&quot;  &quot;萬華&quot;     &quot;招商&quot; &quot;不動產&quot; &quot;、新&quot;  
## [10,] &quot;市最&quot;  &quot;新隆國宅&quot; &quot;重劃&quot; &quot;財長：&quot; &quot;：台&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-109" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (1/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">index &lt;- str_extract(titles, &quot;房貸|所得&quot;)
titles[!is.na(index)]
</code></pre>

<pre><code>## [1] &quot;大同、萬華、北投、淡水、板橋房租房貸差距不大 買比租划算&quot;                     
## [2] &quot;北市買房要不吃不喝15年 所得逾6成都拿去繳房貸&quot;                                
## [3] &quot;彭淮南點名3大因素推高房價 再次提醒注意房貸利率風險&quot;                          
## [4] &quot;財長：豪宅交易設算所得比率 仍未定2014-01-08財長：豪宅交易設算所得比率 仍未定&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-110" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (2/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">index &lt;- str_extract(titles, &quot;店租|標脫&quot;)
titles[!is.na(index)]
</code></pre>

<pre><code>## [1] &quot;樺福千金捷運宅標脫率89.4% 均價63萬元屬合理範圍&quot;      
## [2] &quot;捷運宅標售傳捷報 臨沂帝國5戶順利標脫&quot;                
## [3] &quot;「國美商隱」標脫率7成 單價最高衝上141.5萬&quot;           
## [4] &quot;中山堂旁200坪商四土地 總價14.1億元標脫 溢價率10%&quot;    
## [5] &quot;東區巷內小店租金嚇嚇叫 近5坪月租高達11.25萬元&quot;       
## [6] &quot;北市最貴店租「新名人巷」、每坪上萬　內湖店面租賃最熱&quot;
## [7] &quot;店面熱 北市去年店租1247萬元 內湖占比28%奪冠&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-111" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>一些後續應用</h2>
  </hgroup>
  <article data-timings="">
    <h3>既然已經整理出表格了, 就可以...</h3>

<h3>拿去跑各種奇奇怪怪的迴歸分析 / 機器學習</h3>

<h3>做降維(mds, pca, svd ...)，然後視覺化</h3>

<h3>以上請期待下一輪 R tutorail</h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-112" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>降維視覺化的小範例</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">fit &lt;- cmdscale(d2, eig = TRUE, k=2)
x &lt;- fit$points[,1]
y &lt;- fit$points[,2]
</code></pre>

<pre><code class="r">plot(x, y, xlab=&quot;Coordinate 1&quot;, ylab=&quot;Coordinate 2&quot;, type = &quot;n&quot;)
text(x, y, labels = row.names(t(final_tbl)), cex=.7)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="dark segue" id="slide-113" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>學習，實作，觀察 STEP4</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-114" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>ETL <code>最後一步</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/R_ETL_ETL_2.png' height="350px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-115" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料整併</h2>
  </hgroup>
  <article data-timings="">
    <h3>要處理的標的物有</h3>

<ol>
<li>將<strong>房貸餘額</strong>匯總到<code>每個月</code>的資料</li>
<li>將<strong>GDP</strong>匯總到<code>每年</code>的資料</li>
<li>透過<code>年份</code>將<strong>房貸餘額</strong>與<strong>GDP</strong>的表<code>結合</code>起來</li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-116" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料整併流程</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="./resources/figures/R_ETL_PART4.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-117" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>資料彙總</h2>
  </hgroup>
  <article data-timings="">
    <p>將介紹 <code>group_by</code>, <code>summarize</code>
<img src="./resources/figures/R_ETL_Fn2.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-118" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-資料<code>彙總</code>(1/2)</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:78%' >
 <h3><code>group_by</code> 用來將資料<code>包裝成一組</code>，做後續的彙總</h3>

<h3><code>summarise</code>則用來做後續的各類<code>彙總操作</code></h3>

<pre><code>Cl_info_part3 = group_by(Cl_info_part2,time)  #先匯總
Cl_info_part4 = summarise(Cl_info_part3,
        mortage_total_bal = sum(mortgage_bal, na.rm = TRUE))

</code></pre>

<ul>
<li><code>第一個參數</code>為輸入的 data frame</li>
<li><code>第二個欄位</code>之後都是用來group by/summarise 的欄位</li>
</ul>

<h3>給熟悉<code>SQL</code>的使用者</h3>

<pre><code>select sum(mortgage_bal) as mortage_total_bal 
                        from Cl_info group by time ;
</code></pre>

</div>    
<div style='float:right;width:18%'>
 <p><img src = './resources/figures/R_ETL_DPLYR_SUMMARIZE.png'></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-119">
<img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>group by 可加先下也可不下，不下的情況是直對接<code>全部</code>資料做集匯總運算 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-120" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習-資料<code>彙總</code>(2/2)</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li> 將房貸餘額每個月的值算出來</li>
<li> 將GDP每年的值算出來</li>
</ol>

<pre><code>GDP_part5 = filter(summarise(group_by(GDP_part4,year),GDP=sum(GDP)),is.na(year)==F)        
</code></pre>

<p><img src="./resources/figures/R_ETL_SUMMARIZE.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-121" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>彙總函數 summarise</h2>
  </hgroup>
  <article data-timings="">
    <p>可以使用的函數如下所列</p>

<ul>
<li>mean  平均值</li>
<li>sum   加總 </li>
<li>n     計算個數  例如: A B B C   輸出<code>4</code> </li>
<li>n_distinct 計算不同物件的個數 例: A B B C 輸出<code>3</code></li>
<li>max, min 最大或最小值</li>
<li>median 中位數</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-122" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>mean</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每月全體銀行餘額平均值(eg1)</h3>

<p><img src="./resources/figures/R_ETL_MEAN.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-123" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>n</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每個月有多少家銀行有房貸餘額(eg2)</h3>

<p><img src="./resources/figures/R_ETL_N.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-124" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>n_distinct</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每年有多少家銀行有房貸餘額(eg3)</h3>

<p><img src="./resources/figures/R_ETL_NDISTINCT.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-125" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>max</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每月單一銀行擁有的最多房貸餘額(eg4)</h3>

<p><img src="./resources/figures/R_ETL_MAX.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-126" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>first, last</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每月房貸餘額排名第ㄧ的銀行(eg5)</h3>

<p><img src="./resources/figures/R_ETL_FIRST.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-127" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>複雜一點的函數</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>first 該群體第一個，可配合<code>order_by</code> 使用;  first(x,order_by=y)</li>
<li>last  該群體最後一個，可配合<code>order_by</code> 使用;  last(x,order_by=y)</li>
<li>nth   該群體的第n個，可配合<code>order_by</code> 使用;  nth(x,10))</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-128" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>nth</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每月房貸餘額排名第2的銀行 (eg6)</h3>

<p><img src="./resources/figures/R_ETL_NTH.png"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-129" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習題目- 解答(1/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>

eg1 =  summarise(group_by(Cl_info_part2,time) , 
         mortage_mean_bal = mean(mortgage_bal, na.rm = TRUE))

eg2_1 = filter(Cl_info_part2,mortgage_bal &gt;0)
eg2_2 = summarise(group_by(eg2_1,time),count = n())

eg3_1 = filter(Cl_info_part2,mortgage_bal &gt;0)
eg3_2 = mutate(eg3_1,year = format(time,&quot;%Y&quot;))
eg3_3 = summarise(group_by(eg3_2,year),count = n_distinct(bank_nm))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-130" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習題目- 解答(2/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>eg4 = summarise(group_by(Cl_info_part2,time),
       val = max(mortgage_bal))

eg5 = summarise(group_by(Cl_info_part2,time),
         val = last(bank_nm,order_by=mortgage_bal))


eg6_1 = arrange(Cl_info_part2,time,desc(mortgage_bal))
eg6_2 = summarise(group_by(eg6_1,time),
          val = nth(bank_nm,2))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-131" style="background:red; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>接下來比較難，真的!!!!</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-132" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>結合表格</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>cbind 用來做 <code>1-1</code> <strong>水平</strong>結合</li>
<li>rbind 用來做 <strong>垂直</strong>結合</li>
<li>left_join 用來做<code>多對多</code> <strong>水平</strong>結合</li>
<li>inner_join 用來做<code>多對多</code> <strong>水平</strong>結合</li>
</ol>

<blockquote>
<p>看得懂在幹嘛嗎?</p>
</blockquote>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-133" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>圖解<code>結合表格</code></h2>
  </hgroup>
  <article data-timings="">
    <p><img src="./resources/figures/R_ETL_Fn3.png" width="100%"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-134" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>join講解前資料準備</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:68%' >
 <h3>接下來先從各類join開始說明</h3>

<p>先<code>建立資料集</code></p>

<pre><code>x=data.frame(c1 = c(1,1,2,3,4,5,5),
             c2 = c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;))
y=data.frame(c1 = c(1,2,2,3,4,6,6),
             c2 = c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;))
</code></pre>

</div>    
<div style='float:right;width:28%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-135" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>join講解前資料準備</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:68%' >
 <h3>接下來先從各類join開始說明</h3>

<p>先<code>建立資料集</code></p>

<pre><code class="r">x=data.frame(c1 = c(1,1,2,3,4,5,5),
             c2 = c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;))
y=data.frame(c1 = c(1,2,2,3,4,6,6),
             c2 = c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;))
</code></pre>

<p>打入 <code>View(x)</code>與<code>View(y)</code>應該會看見</p>

</div>    
<div style='float:right;width:28%'>
 <p><img src="./resources/figures/R_ETL_X.png" width="100%"></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-136" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>dplyr 介紹 - left_join</h2>
  </hgroup>
  <article data-timings="">
    <h3>參數<code>by</code> 指出以何欄位作為對照鍵值</h3>

<p>透過先前創建的<code>x</code>與<code>y</code>，以及交集的鍵值<code>c1</code></p>

<pre><code>ljxy = left_join(x,y,by=&quot;c1&quot;) #以X為主
ljyx = left_join(y,x,by=&quot;c1&quot;) #以Y為主
</code></pre>

<p><img src="./resources/figures/R_ETL_LJXY.png" style="height:300px"></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-137" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>dplyr 介紹 - inner_join</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
<h3><code>inner_join</code> 取出共有的鍵值</h3>

<pre><code class="r">inner_join(x,y,by=&quot;c1&quot;)
</code></pre>

<pre><code>##   c1 c2.x c2.y
## 1  1    A    A
## 2  1    B    A
## 3  2    C    B
## 4  2    C    C
## 5  3    D    D
## 6  4    E    E
</code></pre>

</div>
  <div style='float:right;width:48%;'>
<p><img src="./resources/figures/R_ETL_INNERJOIN.png" style="height:400px" ></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-138" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>實際問題 - 練習題</h2>
  </hgroup>
  <article data-timings="">
    <h3>請問，這兩張表該怎麼結合比較好?</h3>

<p><img src="./resources/figures/R_ETL_TWOTABLES.png" style="height:400px" ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-139" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h3>請問，這兩張表該怎麼結合比較好?用誰當第一參數?</h3>
  </hgroup>
  <article data-timings="">
    
<div class='row-fluid'>
  <div class='span6'>
    <p><img src="./resources/figures/R_ETL_TWOTABLES.png" style="height:400px" ></img></p>

  </div>
  <div class='span6'>
    <div class="quiz quiz-single well new">
      <ol>
<li>left_join Cl_Info_part4</li>
<li>semi_join Cl_Info_part4</li>
<li><em>left_join GDP_part5</em></li>
<li><em>inner_join GDP_part5</em></li>
<li>其他</li>
</ol>

      <button class="quiz-submit btn btn-primary">Submit</button>
      <button class="quiz-toggle-hint btn btn-info">Show Hint</button>
      <button class="quiz-show-answer btn btn-success">Show Answer</button>
      <button class="quiz-clear btn btn-danger">Clear</button>
      
      <div class="quiz-explanation">
  <p>因為GDP_part5_所俱有的<code>時間點</code>較少，用這個當作主鍵是比較好的.</p>

</div>
    </div>
  </div>
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-140" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>練習</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>將GDP與房貸餘額，透過1月的資訊整理起來</li>
</ol>

<pre><code>GDP_part6 = select(mutate(GDP_part5 ,                    
                   time = as.POSIXct(paste(year,&#39;1&#39;,&#39;1&#39;,sep=&#39;-&#39;))),time,GDP)
t1 = left_join(GDP_part6,Cl_info_part4,by=&quot;time&quot;)
t2 = filter(t1,is.na(mortage_total_bal)==FALSE)
</code></pre>

<p>看一下資料 <code>View(t2)</code></p>

<p><img src="./resources/figures/R_ETL_t2.png" style="height:200px" ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-141" style="background:indigo; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>最後一里路</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-142" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>接下來我們應該做(1/3) - 畫圖</h2>
  </hgroup>
  <article data-timings="">
    <pre><code>see1 = filter(mutate(t2,ratio =mortage_total_bal/GDP),is.na(ratio)==FALSE)
</code></pre>
  
<div style='float:left;width:18%' >
 <ol>
<li><code>畫圖</code></li>
</ol>

</div>    
<div style='float:right;width:78%'>
 <pre><code class="r">library(ggplot2)
ggplot(see1, aes(time, ratio))+geom_smooth(method=&quot;loess&quot;) +
  scale_size_area() +geom_point(aes(size = 20), alpha = 1/2) 
</code></pre>

<p><img src="assets/fig/plotChunk.png" alt="plot of chunk plotChunk"> </p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-143" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>接下來我們應該做(2/3) - 解釋</h2>
  </hgroup>
  <article data-timings="">
    <p>利用<code>解釋</code>將圖想要表達的意思更清楚地傳達給觀眾</p>
  
<div style='float:left;width:18%' >
 <ol>
<li>畫圖</li>
<li><code>解釋</code></li>
</ol>

</div>    
<div style='float:right;width:78%'>
 <ol>
<li>09達到高峰，但之後房貸與GDP的比值平穩維持在37.5%</li>
<li>GDP成長比率與房貸餘額幾乎成正比</li>
<li>從新聞顯示

<ul>
<li>09年遺產稅調降, 許多人回來<code>投資</code>?<code>炒房</code>?</li>
<li>10年開始打房政策</li>
<li>如果加上<code>房價所得比</code>，還可以說什麼呢?</li>
</ul></li>
</ol>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-144" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>接下來我們應該做(3/3) - 報告</h2>
  </hgroup>
  <article data-timings="">
    <p>將所有的解釋與圖表<code>包裝成一個故事</code>，展現出來</p>
  
<div style='float:left;width:18%' >
 <ol>
<li>畫圖</li>
<li>解釋</li>
<li><code>報告</code></li>
</ol>

</div>    
<div style='float:right;width:78%'>
 <p><img src="./resources/figures/R_ETL_Presentation.png" style="height:400px" ></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-145" style="background:orange; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>Review</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-146" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>我們做了什麼?</h2>
  </hgroup>
  <article data-timings="">
      
<div style='float:left;width:18%' >
 <ul class = "build incremental">
<li>設定問題</li>
<li>下載與讀入與整理</li>
<li>整合資料</li>
<li>畫圖</li>
<li>解釋</li>
<li>報告</li>
</ul>

</div>    
<div style='float:right;width:78%'>
 <p><img src = './resources/figures/R_ETL_ETL_MAP.png' height="350px"></img></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-147" style="background:green; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>額外延伸主題</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-148" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>自動化</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>建立R Script</li>
</ul>

<pre><code>iris
iris_part &lt;- iris[4:6,]
rownames(iris_part) &lt;- c(&#39;a&#39;,&#39;c&#39;,&#39;d&#39;)
write.csv(iris_part,file=&quot;[想要的目錄]/GG.csv&quot;)
</code></pre>

<ul>
<li>儲存到特定位置下  假定叫做Script.R</li>
<li>在terminal執行</li>
</ul>

<pre><code>R CMD BATCH [該檔案儲存位置]/Script.R
</code></pre>

<ul>
<li>可透過<code>crontab</code>定期執行</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-149" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>從網路讀檔案</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>安裝套件</li>
</ul>

<pre><code>install.packages(&quot;RCurl&quot;)
library(RCurl)
</code></pre>

<ul>
<li>讀檔案</li>
</ul>

<pre><code>DF = read.table(sep=&quot;,&quot;, header=TRUE,            
file= textConnection(
getURL(&quot;https://raw.githubusercontent.com/ntuaha/TWFS/master/db/cl_info_other.csv&quot;)
))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-150" style="background:blue; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>Speical</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-151" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>Topics</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>自動化排程</li>
<li>與資料庫溝通</li>
<li>其他的資料源

<ul>
<li>結構化資料</li>
<li>非結構化資料</li>
</ul></li>
<li>培養對資料的品味</li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-152" style="background:; background-repeat:no-repeat; background-position:center; ">
  <img src="assets/img/Taiwan-R-logo.png" class="logo fit100" />
  <hgroup>
    <h2>Reference</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li><a href="http://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">http://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html</a></li>
<li><a href="http://cran.r-project.org/web/packages/dplyr/dplyr.pdf">http://cran.r-project.org/web/packages/dplyr/dplyr.pdf</a></li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='故事的起源'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='故事的起源'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='故事的起源'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title=''>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title=''>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title=''>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='資料在哪裡'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='資料在哪裡'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='資料在哪裡'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title=''>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='看看Raw Data'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='我們ETL會用到的有'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title=''>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='DSC的One Piece'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='解決資料散亂的方法 - <code>ETL</code>'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='ETL 的主要內容'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='今日解決的問題流程 - <code>ETL</code>'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='今日課程的目標'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='學習，實作，觀察 STEP1'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='ETL <code>第一步</code>'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='開始收集資料(房貸餘額)'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='開始收集資料'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='讀入資料 - read.table'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='看看讀入結果'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title=''>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='再看一次'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='Transformation - 資料處理'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title=''>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title=''>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title=''>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='練習-挑選<code>欄位</code>(1/2)'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='練習-挑選<code>欄位</code>(2/2)'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='練習-挑選<code>資料</code>'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='練習-增加<code>特徵</code>欄位(1/2)'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='練習-增加<code>特徵</code>欄位(2/2)'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='練習-<code>排序</code>資料(1/2)'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='練習-<code>排序</code>資料(2/2)'>
         37
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=38 title='練習時間'>
         38
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=39 title='學習，實作，觀察 STEP2'>
         39
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=40 title=''>
         40
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=41 title='ETL <code>第二步</code>'>
         41
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=42 title='開始收集資料(GDP)'>
         42
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=43 title='開始收集資料(GDP)'>
         43
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=44 title=''>
         44
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=45 title=''>
         45
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=46 title=''>
         46
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=47 title='資料清理'>
         47
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=48 title='去除前後不相干的資料列'>
         48
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=49 title='去除rownames'>
         49
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=50 title='轉移文字格式'>
         50
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=51 title='抽離年份與季'>
         51
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=52 title='練習時間'>
         52
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=53 title=''>
         53
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=54 title=''>
         54
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=55 title='學習，實作，觀察 STEP3'>
         55
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=56 title='ETL <code>第三步</code>'>
         56
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=57 title='匯入套件'>
         57
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=58 title='先 check / 安裝 聯結 Selenium 的 driver'>
         58
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=59 title='打開 瀏覽器'>
         59
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=60 title='抓 yahoo 新聞'>
         60
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=61 title='抓 yahoo 搜尋結果'>
         61
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=62 title='抓搜尋結果'>
         62
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=63 title='儲存 / 讀取 表格資料'>
         63
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=64 title='優缺點'>
         64
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=65 title='匯入這次用的資料'>
         65
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=66 title='抓出 時間 與 文章'>
         66
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=67 title='有了新聞後，怎麼知道有哪些單字？'>
         67
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=68 title='有了新聞後，怎麼知道有哪些單字？'>
         68
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=69 title='等下要用到的工具 -&gt; substr'>
         69
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=70 title='N-Grame'>
         70
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=71 title='把 N-Gram 詞彙匯聚在一起'>
         71
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=72 title='清除符號 (只是列出來，並沒有要做)'>
         72
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=73 title='如果想清除中文特殊符號 ...'>
         73
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=74 title='算 單字 出現次數'>
         74
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=75 title='分出 單字長度 區塊'>
         75
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=76 title='等下要用到工具'>
         76
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=77 title='算出機率'>
         77
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=78 title='等下要用的工具 paste, grep'>
         78
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=79 title='算出單字左右亂度'>
         79
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=80 title='可以先用簡單例子看一下上面的結果'>
         80
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=81 title='挑出文章裡面的 單字'>
         81
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=82 title='單字 出現次數分佈'>
         82
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=83 title='算出 候選詞彙 左右兩側的混亂程度'>
         83
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=84 title='單字的 混亂程度分佈'>
         84
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=85 title='混亂程度'>
         85
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=86 title='挑出 混亂程度&gt;12 的單字'>
         86
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=87 title='切單字'>
         87
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=88 title='用法'>
         88
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=89 title='可以用這例子來理解'>
         89
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=90 title='算單字的凝聚程度'>
         90
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=91 title='用這例子來理解, 依序為 f_word, f_x1, f_x2'>
         91
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=92 title='等下要用到的工具 -&gt; str_count'>
         92
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=93 title='算出單字 每個時間點的 出現次數'>
         93
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=94 title='轉換成 xts格式'>
         94
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=95 title='對時間區間做運算'>
         95
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=96 title='下載營建股 股票指數'>
         96
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=97 title='開始下載'>
         97
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=98 title='算出每支股票的 平均漲跌'>
         98
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=99 title='全部平均來看 ...'>
         99
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=100 title='找出股票漲跌的五個狀態'>
         100
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=101 title='如果想知道其中的 <code>相關性</code> ...'>
         101
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=102 title='如果可以把<code>5個漲跌狀態</code>變成欄位 ...'>
         102
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=103 title='整理出需要的欄位狀態'>
         103
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=104 title='欄位旋轉'>
         104
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=105 title='把<code>關鍵字</code>和<code>股票漲跌</code>依據<code>時間</code>做合併'>
         105
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=106 title='算 彼此之間的相關度'>
         106
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=107 title='和<code>漲跌狀態</code>有關的<code>關鍵字</code>'>
         107
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=108 title='整理一下 ...'>
         108
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=109 title='漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (1/2)'>
         109
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=110 title='漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (2/2)'>
         110
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=111 title='一些後續應用'>
         111
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=112 title='降維視覺化的小範例'>
         112
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=113 title='學習，實作，觀察 STEP4'>
         113
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=114 title='ETL <code>最後一步</code>'>
         114
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=115 title='資料整併'>
         115
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=116 title='資料整併流程'>
         116
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=117 title='資料彙總'>
         117
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=118 title='練習-資料<code>彙總</code>(1/2)'>
         118
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=119 title=''>
         119
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=120 title='練習-資料<code>彙總</code>(2/2)'>
         120
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=121 title='彙總函數 summarise'>
         121
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=122 title='mean'>
         122
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=123 title='n'>
         123
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=124 title='n_distinct'>
         124
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=125 title='max'>
         125
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=126 title='first, last'>
         126
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=127 title='複雜一點的函數'>
         127
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=128 title='nth'>
         128
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=129 title='練習題目- 解答(1/2)'>
         129
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=130 title='練習題目- 解答(2/2)'>
         130
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=131 title='接下來比較難，真的!!!!'>
         131
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=132 title='結合表格'>
         132
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=133 title='圖解<code>結合表格</code>'>
         133
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=134 title='join講解前資料準備'>
         134
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=135 title='join講解前資料準備'>
         135
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=136 title='dplyr 介紹 - left_join'>
         136
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=137 title='dplyr 介紹 - inner_join'>
         137
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=138 title='實際問題 - 練習題'>
         138
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=139 title='請問，這兩張表該怎麼結合比較好?用誰當第一參數?'>
         139
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=140 title='練習'>
         140
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=141 title='最後一里路'>
         141
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=142 title='接下來我們應該做(1/3) - 畫圖'>
         142
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=143 title='接下來我們應該做(2/3) - 解釋'>
         143
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=144 title='接下來我們應該做(3/3) - 報告'>
         144
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=145 title='Review'>
         145
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=146 title='我們做了什麼?'>
         146
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=147 title='額外延伸主題'>
         147
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=148 title='自動化'>
         148
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=149 title='從網路讀檔案'>
         149
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=150 title='Speical'>
         150
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=151 title='Topics'>
         151
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=152 title='Reference'>
         152
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  <script src="libraries/widgets/quiz/js/jquery.quiz.js"></script>
<script src="libraries/widgets/quiz/js/mustache.min.js"></script>
<script src="libraries/widgets/quiz/js/quiz-app.js"></script>
<script src="libraries/widgets/bootstrap/js/bootstrap.min.js"></script>
<script src="libraries/widgets/bootstrap/js/bootbox.min.js"></script>

  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script>  
  $(function (){ 
    $("#example").popover(); 
    $("[rel='tooltip']").tooltip(); 
  });  
  </script>  
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>